@startuml
title "Next.js 15 App (Client) Subsystem - Class Diagram"

skinparam classAttributeIconSize 0
skinparam defaultFontName "Malgun Gothic"
skinparam shadowing false

' --- External API Interfaces ---
interface "IApiGateway" {
  + login(email, password)
  + register(userInfo)
  + getMenu()
  + calculateDiscount(cart)
  + createOrder(orderData)
  + connectOrderStatusSocket(orderId)
  + sendChatbotOrder(structuredOrder)
}

interface "IGeminiApi" {
  + speechToText(audioStream)
  + textToNlp(text)
  + generateImage(prompt)
}

' --- Core Data Models ---
class "User" {
  + userId: string
  + email: string
  + name: string
}

class "MenuItem" {
  + itemId: string
  + name: string
  + price: number
  + imageUrl: string
}

class "CartItem" {
  + item: MenuItem
  + quantity: number
}

' --- Hooks (State & Logic) ---
class "useAuth" <<hook>> {
  + user: User
  + jwt: string
  + login(email, password)
  + logout()
  + register(userInfo)
}
useAuth ..> "IApiGateway" : "인증 요청"
useAuth o-- "User"

class "useCart" <<hook>> {
  + items: CartItem[]
  + addItem(item: MenuItem)
  + removeItem(itemId: string)
  + updateQuantity(itemId: string, quantity: number)
  + clearCart()
}
useCart o-- "CartItem"

' --- Main Components / Modules ---
class "MenuBrowser" {
  + displayMenu()
}
MenuBrowser ..> "IApiGateway" : "메뉴 조회"
MenuBrowser ..> "useCart" : "항목 추가"
MenuBrowser o-- "MenuItem"

class "CheckoutModule" {
  + deliveryAddress: string
  + requests: string
  + handleCheckout()
}
CheckoutModule ..> "useCart" : "장바구니 조회"
CheckoutModule ..> "useAuth" : "사용자 조회"
CheckoutModule ..> "IApiGateway" : "할인 요청"
CheckoutModule ..> "IApiGateway" : "주문/결제 요청"

class "ChatbotUI" {
  + handleVoiceInput()
  + handleTextInput()
}
ChatbotUI ..> "IGeminiApi" : "ASR/NLP/GenAI"
ChatbotUI ..> "IApiGateway" : "주문 전송"
ChatbotUI ..> "useCart" : "항목 추가"

class "OrderStatusTracker" {
  + orderId: string
  + status: string
  + connect()
}
OrderStatusTracker ..> "IApiGateway" : "WebSocket 연결"

@enduml