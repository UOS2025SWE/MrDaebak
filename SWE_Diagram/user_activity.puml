@startuml
title Mr. Daebak Dinner Delivery System Activity Diagram (Voice & GUI Order)

|Customer|
start
:Visit Website/App;
if (Logged In?) then ([Yes])
else ([No])
:Log In / Sign Up;
endif

if (Select Voice Order?) then ([Voice])
  :Click "음성 주문" 버튼;
  |System|
  :Greet customer by name and ask for dinner preference;
  |Customer|
  :"맛있는 디너 추천해주세요" 요청;
  |System|
  :Ask for celebration date;
  |Customer|
  :Provide celebration date (예: "내일이 어머님 생신");
  |System|
  :Recommend "프렌치" vs "샴페인 축제" 디너;
  |Customer|
  :Select "샴페인 축제 디너";
  |System|
  :Suggest "디럭스" 서빙 스타일;
  |Customer|
  :Accept deluxe serving;
  |System|
  :Summarize dinner & serving selection;
  |Customer|
  :Request modifications (바게트 6개, 샴페인 2병);
  |System|
  :Update order summary and confirm no extra requests;
  |Customer|
  :Confirm voice order details;
else ([GUI])
  :Browse dinner packages (발렌타인/프렌치/잉글리시/샴페인 축제);
  :Select dinner package;
  :Choose serving style (simple/grand/deluxe);
  :Adjust 바게트 수량 (1 -> 6);
  :Adjust 와인/샴페인 수량 (1 -> 2);
  if (Need additional items?) then ([Yes])
    :Add sides or beverages;
  endif
endif

if (Custom decoration needed?) then ([Yes])
  |Customer|
  :Upload photo or request AI image;
  |System|
  :Call GenAI for cake topper preview;
endif

|Customer|
:Enter delivery address and contact;
:Select delivery date (12월2일 또는 12월3일);
:Add celebration note for packaging;

|System|
:Validate inventory & schedule availability;
if (Schedule conflict?) then ([Yes])
  :Display alternative delivery slots;
  |Customer|
  :Choose new delivery date/time;
endif
|System|
:Create order draft and mark status 'Scheduled';
if (Regular Customer Conditions Met?) then ([Yes])
  :Apply loyalty discount;
endif
:Calculate final price with modifications;

|Customer|
:Proceed to payment (credit card);

|System|
:Process payment with external PG;
if (Payment Successful?) then ([Yes])
  :Commit order & reservation;
  :Send confirmation (voice + push + email);
  :Notify staff with scheduled prep time;
  |Staff|
  :Review scheduled order queue;
  :Allocate ingredients for selected date;
  |System|
  :Deduct reserved inventory quantities;
  |Staff|
  :On delivery date start cooking;
  :Update status 'Cooking' -> 'Out for Delivery' -> 'Delivered';
  |System|
  :Notify customer of each status change;
  |Customer|
  :Acknowledge delivery completion;
  stop
else ([No])
  :Notify payment failure;
  |Customer|
  :Retry payment or cancel order;
  stop
endif
@enduml