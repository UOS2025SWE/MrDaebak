1 "Customer Web App" 서브시스템 세부 설계

"Customer Web App" 시스템은 고객이 웹 브라우저를 통해 음식 주문, 결제, 배달 추적, 이벤트 조회 등의 기능을 이용할 수 있도록 하는 프론트엔드 애플리케이션이다.

고객은 전통적인 GUI 방식뿐만 아니라 음성 주문을 통해서도 주문을 진행할 수 있다.
실시간으로 주문 상태를 확인하고 WebSocket을 통해 상태 변경 알림을 받는다.
메뉴 조회 시 스타일(simple, grand, deluxe) 선택 및 재료 커스터마이징이 가능하다.
프로모션 이벤트 정보를 조회하고 할인 혜택을 확인할 수 있다.
사용자 프로필 관리 및 과거 주문 내역 조회 기능을 제공한다.

"Customer Web App" 시스템은 아래와 같은 중요한 페이지들로 구성되어 있다. 각 페이지는 "Backend API" 시스템에 요청을 전송하여 필요한 데이터를 조회하거나 작업을 수행한다.

HomePage
메인 페이지로, 프로모션 및 이벤트 정보를 표시한다.
추천 메뉴 및 인기 메뉴를 확인할 수 있다.
loadHomeData() 함수를 통해 백엔드로부터 홈 화면에 표시할 데이터를 로드한다.

MenuPage
전체 메뉴 목록을 조회하고 카테고리별로 필터링할 수 있다.
각 메뉴의 스타일(simple, grand, deluxe) 선택 및 재료 커스터마이징이 가능하다.
사이드 디시 선택 기능을 제공한다.
selectMenu() 함수로 메뉴를 선택하고, selectStyle() 함수로 스타일을 선택한다.
updateCustomization() 함수를 통해 재료 수량을 조정하고, addToCart() 함수로 장바구니에 추가한다.

CheckoutPage
배달 주소 및 결제 정보를 입력한다.
주문을 최종 확정하고 "Order & Checkout Domain" 시스템에 주문 요청을 전송한다.
loadDefaultDeliveryInfo() 함수로 저장된 배송지를 로드하고, submitCheckout() 함수로 결제를 처리한다.

OrdersPage
과거 주문 내역을 조회하고 재주문할 수 있다.
loadOrders() 함수로 사용자의 주문 목록을 로드하고, reorder() 함수로 재주문을 수행한다.

OrderDetailPage
주문 후 배달 진행 상태를 실시간으로 확인한다.
WebSocket을 통해 주문 상태 변경 알림을 받는다.
loadOrder() 함수로 주문 상세 정보를 로드하고, listenOrderStatus() 함수로 WebSocket 연결을 설정한다.

VoiceOrderPage
음성 인식을 통해 주문을 진행한다.
"Voice & Realtime Domain" 시스템과 연동하여 STT(Speech-to-Text) 기능을 활용한다.
startRecording() 함수로 녹음을 시작하고, stopRecording() 함수로 녹음을 중지한다.
sendTranscript() 함수로 음성 텍스트를 AI 분석 API로 전송하고, confirmOrder() 함수로 주문을 확정한다.

EventsPage
현재 진행 중인 프로모션 및 이벤트 정보를 조회한다.
할인 쿠폰 및 포인트 적립 정보를 확인할 수 있다.

ProfilePage
사용자 프로필 관리 및 주문 이력 조회 기능을 제공한다.
loadProfile() 함수로 사용자 정보를 로드하고, updateProfile() 함수로 프로필을 수정한다.


1.1 메인 클래스도

AuthContext (contexts/AuthContext.tsx)

"Customer Web App" 시스템은 AuthContext를 통해 사용자 인증 상태를 전역적으로 관리한다.
user 변수에 현재 로그인한 사용자 정보를 저장하고, token 변수에 JWT 액세스 토큰을 저장한다.
loading 변수는 인증 처리 중인지 여부를 나타낸다.
login(email, password) 함수는 백엔드 /api/auth/login 엔드포인트로 로그인 요청을 전송하고, 성공 시 토큰을 localStorage에 저장한다.
logout() 함수는 토큰을 제거하고 사용자 정보를 초기화한다.
isLoggedIn() 함수는 현재 로그인 여부를 확인한다.

ToastContext (contexts/ToastContext.tsx)

"Customer Web App" 시스템은 ToastContext를 통해 알림 메시지를 전역적으로 관리한다.
toasts 배열에 현재 표시 중인 알림 메시지 목록을 저장한다.
showToast(message, type) 함수는 새로운 알림 메시지를 추가하며, type은 "success", "error", "warning", "info" 중 하나이다.
removeToast(id) 함수는 특정 알림 메시지를 제거한다.

HomePage (app/page.tsx)

HomePage는 애플리케이션의 메인 페이지를 나타낸다.
featuredEvents 변수에 추천 이벤트 목록을 저장하고, featuredMenus 변수에 추천 메뉴 목록을 저장한다.
loadHomeData() 함수는 백엔드 API로부터 추천 이벤트 및 메뉴 데이터를 조회한다.
AuthContext와 ToastContext에 의존하여 사용자 인증 상태 및 알림 메시지를 관리한다.

MenuPage (app/menu/page.tsx)

MenuPage는 메뉴 조회 및 선택 페이지를 나타낸다.
menus 배열에 전체 메뉴 목록을 저장하고, selectedMenu에 현재 선택된 메뉴를 저장한다.
selectedStyle에 선택된 스타일(simple, grand, deluxe)을 저장하고, customizations 객체에 재료 커스터마이징 정보를 저장한다.
loadMenu() 함수는 백엔드 /api/menu/ 엔드포인트로부터 메뉴 목록을 조회한다.
selectMenu(code) 함수는 특정 메뉴를 선택하고, selectStyle(style) 함수는 스타일을 선택한다.
updateCustomization(ingredient, qty) 함수는 재료 수량을 조정한다.
addToCart() 함수는 선택한 메뉴를 장바구니에 추가하며, 실제로는 체크아웃 페이지로 이동한다.

CheckoutPage (app/checkout/page.tsx)

CheckoutPage는 주문 확정 및 결제 페이지를 나타낸다.
deliveryInfo 객체에 배송 정보(주소, 수령인, 연락처)를 저장하고, paymentInfo 객체에 결제 정보(카드 번호, 만료일, CVC)를 저장한다.
pricing 객체에 가격 요약 정보(원가, 할인 금액, 최종 금액)를 저장한다.
loadDefaultDeliveryInfo(userId) 함수는 사용자의 기본 배송지 정보를 로드한다.
submitCheckout() 함수는 백엔드 /api/checkout/checkout 엔드포인트로 주문 및 결제 요청을 전송한다.

OrdersPage (app/orders/page.tsx)

OrdersPage는 주문 내역 조회 페이지를 나타낸다.
orders 배열에 사용자의 과거 주문 목록을 저장한다.
loadOrders(userId) 함수는 백엔드 /api/orders/user/{userId} 엔드포인트로부터 주문 목록을 조회한다.
reorder(orderId) 함수는 백엔드 /api/orders/reorder/{orderId} 엔드포인트로 재주문 요청을 전송한다.

OrderDetailPage (app/orders/[orderId]/page.tsx)

OrderDetailPage는 특정 주문의 상세 정보 및 실시간 상태를 표시하는 페이지이다.
order 객체에 주문 상세 정보를 저장하고, wsConnected 변수에 WebSocket 연결 상태를 저장한다.
loadOrder(orderId) 함수는 백엔드 /api/orders/{orderId} 엔드포인트로부터 주문 상세 정보를 조회한다.
listenOrderStatus() 함수는 WebSocket 연결을 설정하고, ORDER_STATUS_CHANGED 메시지를 수신하여 주문 상태를 실시간으로 업데이트한다.

VoiceOrderPage (app/voice/page.tsx)

VoiceOrderPage는 음성 주문 페이지를 나타낸다.
transcript 변수에 음성 인식 결과 텍스트를 저장하고, aiResponse 변수에 AI 응답 메시지를 저장한다.
orderPreview 객체에 AI가 분석한 주문 내용(메뉴, 스타일, 수량, 커스터마이징)을 저장한다.
startRecording() 함수는 브라우저 마이크를 통해 음성 녹음을 시작한다.
stopRecording() 함수는 녹음을 중지하고 음성 파일을 생성한다.
sendTranscript() 함수는 백엔드 /api/voice/analyze 엔드포인트로 음성 텍스트를 전송하고, AI 분석 결과를 받는다.
confirmOrder() 함수는 AI가 제안한 주문 내용을 확인하고 실제 주문을 생성한다.

EventsPage (app/events/page.tsx)

EventsPage는 프로모션 이벤트 조회 페이지를 나타낸다.
events 배열에 현재 진행 중인 이벤트 목록을 저장한다.
loadEvents() 함수는 백엔드 /api/events/ 엔드포인트로부터 활성 이벤트 목록을 조회한다.

ProfilePage (app/profile/page.tsx)

ProfilePage는 사용자 프로필 관리 페이지를 나타낸다.
userInfo 객체에 사용자 정보(이름, 이메일, 전화번호, 주소)를 저장한다.
loadProfile() 함수는 백엔드 /api/auth/me 엔드포인트로부터 사용자 정보를 조회한다.
updateProfile(data) 함수는 수정된 사용자 정보를 백엔드로 전송한다.

ProtectedRoute (components/ProtectedRoute.tsx)

ProtectedRoute는 인증이 필요한 페이지를 보호하는 컴포넌트이다.
AuthContext에서 로그인 상태를 확인하고, 미로그인 시 로그인 페이지로 리다이렉트한다.
render(children) 함수는 인증된 사용자에게만 자식 컴포넌트를 렌더링한다.

Header (components/Header.tsx)

Header는 애플리케이션 상단 네비게이션 바를 나타내는 컴포넌트이다.
로고, 메뉴 링크, 로그인/로그아웃 버튼 등을 포함한다.

Footer (components/Footer.tsx)

Footer는 애플리케이션 하단 푸터를 나타내는 컴포넌트이다.
저작권 정보, 이용약관, 개인정보처리방침 링크 등을 포함한다.

ToastContainer (components/ToastContainer.tsx)

ToastContainer는 알림 메시지를 화면에 표시하는 컴포넌트이다.
ToastContext로부터 toasts 배열을 가져와서 각 알림 메시지를 렌더링한다.

Backend API (인터페이스)

"Customer Web App" 시스템의 모든 페이지는 Backend API 인터페이스를 통해 백엔드 시스템과 통신한다.
이 인터페이스는 실제로는 "Order & Checkout Domain", "Menu & Inventory Domain", "Event & Discount Domain", "User & Auth Domain", "Voice & Realtime Domain" 등의 백엔드 시스템에 구현되어 있다.
