Dinner Service System 배치 다이어그램 설명

================================================================================

Dinner Service 시스템은 여덟 개의 노드에 분산되어 배포된다.
    Client Browser 노드
    Frontend Container 노드
    Backend Container 노드
    Database Container 노드
    Reverse Proxy Container 노드
    Google Gemini API 노드
    OpenAI API 노드
    Mock Payment Gateway 노드


배치 다이어그램 구성 요소

배치 다이어그램은 컴포넌트, 아티팩트, 노드, 세 가지 주요 요소로 구성된다.

컴포넌트는 Component View에서 정의된 논리적 소프트웨어 단위이다. 시스템의 기능적 모듈을 나타내며 실행 시점에 노드에 배포된다. Dinner Service 시스템은 11개의 컴포넌트로 구성된다.

아티팩트는 물리적 구현 단위로 실행 파일, 라이브러리, 설정 파일, 데이터 파일을 포함한다. 컴포넌트를 실제로 구현하는 파일들이며 노드에 설치된다. Dinner Service 시스템은 8개의 아티팩트를 사용한다.

노드는 소프트웨어가 실행되는 물리적 또는 논리적 컴퓨팅 자원이다. 서버, 컨테이너, 클라이언트 디바이스, 외부 서비스를 포함하며 컴포넌트와 아티팩트를 호스팅한다.


Client Browser 노드

Customer Web App, Admin & Staff Web App, Common Components 컴포넌트를 배포한다.

Customer Web App 컴포넌트는 Component View에서 정의된 고객용 웹 애플리케이션이다. 주문, 메뉴 조회, 음성 주문, 결제 기능을 제공하는 클라이언트 프로그램으로 브라우저에서 JavaScript로 실행된다.

Admin & Staff Web App 컴포넌트는 Component View에서 정의된 관리자 및 직원용 웹 애플리케이션이다. 대시보드, 주문 관리, 메뉴 관리 기능을 제공하는 클라이언트 프로그램으로 역할별로 다른 화면을 표시한다.

Common Components 컴포넌트는 Component View에서 정의된 전역 공통 UI 컴포넌트이다. Header, Footer, UserDropdown 등을 제공하며 모든 페이지에서 재사용된다.


Frontend Container 노드 (dinner_service-frontend)

Frontend Container 노드는 Docker 컨테이너로 Next.js 애플리케이션을 실행한다.

next-app.js 아티팩트를 설치한다. Next.js Server로 React 컴포넌트를 서버에서 렌더링하고 HTML을 생성하는 실행 파일이다. 포트 3000에서 실행되며 Frontend Container를 구현한다.

build/ 아티팩트를 설치한다. 빌드된 정적 자산으로 HTML, CSS, JavaScript, 이미지 파일을 포함하는 디렉토리이다. 클라이언트 브라우저로 전송되며 Frontend Container를 구현한다.


Backend Container 노드 (dinner_service-backend)

API Routers, Domain Services, Integration & Realtime, Persistence 컴포넌트를 배포한다.

API Routers 컴포넌트는 Component View에서 정의된 HTTP 요청 라우팅 및 WebSocket 연결 관리 계층이다. 14개의 Router가 클라이언트 요청을 받아 Domain Services로 위임하는 Presentation Layer 프로그램이다.

Domain Services 컴포넌트는 Component View에서 정의된 비즈니스 로직 캡슐화 계층이다. 10개의 Service가 도메인 규칙을 적용하고 비즈니스 기능을 제공하는 Service Layer 프로그램이다.

Integration & Realtime 컴포넌트는 Component View에서 정의된 외부 서비스 통합 및 실시간 통신 계층이다. 4개의 Adapter가 외부 API를 호출하고 내부 도메인 모델로 변환하는 Adapter Layer 프로그램이다.

Persistence 컴포넌트는 Component View에서 정의된 데이터베이스 연결 및 트랜잭션 관리 계층이다. Database, SessionLocal, Engine 모듈이 SQLAlchemy ORM으로 데이터베이스 작업을 추상화하는 Data Access Layer 프로그램이다.

main.py 아티팩트를 설치한다. FastAPI 애플리케이션 진입점으로 모든 컴포넌트를 초기화하고 라우터를 등록하는 실행 파일이다. Backend Container를 구현한다.

uvicorn 아티팩트를 설치한다. ASGI 서버로 FastAPI 애플리케이션을 실행하는 실행 파일이다. 포트 8000에서 실행되며 Backend Container를 구현한다.


Database Container 노드 (dinner_service_db)

Database Container 노드는 Docker 컨테이너로 PostgreSQL 데이터베이스를 실행한다.

postgres 아티팩트를 설치한다. PostgreSQL 17 데이터베이스 서버로 SQL 쿼리를 처리하고 트랜잭션을 관리하는 실행 파일이다. 포트 5432에서 실행되며 Database Container를 구현한다.

pgdata/ 아티팩트를 설치한다. 데이터베이스 파일들이 저장되는 영구 볼륨 디렉토리이다. 주문, 사용자, 메뉴, 재고 등 모든 애플리케이션 데이터가 저장되며 Database Container를 구현한다.


Reverse Proxy Container 노드 (dinner_service_caddy)

Reverse Proxy Container 노드는 Docker 컨테이너로 Caddy 리버스 프록시를 실행한다.

caddy 아티팩트를 설치한다. HTTP/HTTPS 리버스 프록시로 SSL 종료 및 라우팅을 담당하는 실행 파일이다. 포트 80(HTTP)과 443(HTTPS)에서 실행되며 클라이언트 요청을 Frontend Container와 Backend Container로 분배한다. Reverse Proxy Container를 구현한다.

Caddyfile 아티팩트를 설치한다. 라우팅 규칙과 TLS 설정을 정의하는 설정 파일이다. /customer, /admin 경로는 Frontend Container로, /api/*, /ws/* 경로는 Backend Container로 라우팅하며 Reverse Proxy Container를 구현한다.


Google Gemini API 노드

LLM, Stable Diffusion 컴포넌트를 배포한다.

LLM 컴포넌트는 Component View에서 정의된 대화형 AI 서비스이다. 음성 주문 분석과 AI 응답 생성 기능을 제공하며 gemini-2.5-flash 모델을 사용한다. Integration & Realtime 컴포넌트의 GeminiService가 HTTPS로 호출한다.

Stable Diffusion 컴포넌트는 Component View에서 정의된 이미지 생성 AI 서비스이다. 케이크 이미지 생성 및 편집 기능을 제공하며 gemini-2.5-flash-image 모델을 사용한다. Integration & Realtime 컴포넌트의 GeminiImageService가 HTTPS로 호출한다.


OpenAI API 노드

STT, TTS 컴포넌트를 배포한다.

STT 컴포넌트는 Component View에서 정의된 음성 인식 서비스이다. 음성을 텍스트로 변환하는 기능을 제공하며 gpt-4o-mini-transcribe 모델을 사용한다. Integration & Realtime 컴포넌트의 OpenAIAudioService가 HTTPS로 호출한다.

TTS 컴포넌트는 Component View에서 정의된 음성 합성 서비스이다. 텍스트를 음성으로 변환하는 기능을 제공하며 gpt-4o-mini-tts 모델을 사용한다. Integration & Realtime 컴포넌트의 OpenAIAudioService가 HTTPS로 호출한다.


Mock Payment Gateway 노드

Mock Payment Gateway 노드는 외부 서비스로 결제 시뮬레이션을 제공한다. Integration & Realtime 컴포넌트의 PaymentService가 HTTPS로 호출하여 결제를 처리한다. 프로덕션 환경에서는 실제 PG사 API로 대체된다.


물리적 연결 및 통신 경로

Client Browser와 Reverse Proxy Container는 HTTP/HTTPS 프로토콜로 연결된다. 포트 80과 443을 사용하여 통신하며 클라이언트의 모든 요청이 이 경로를 통해 전달된다.

Reverse Proxy Container와 Frontend Container는 HTTP 프로토콜로 연결된다. 포트 3000을 사용하여 통신하며 /customer, /admin 경로 요청이 이 경로를 통해 전달된다.

Reverse Proxy Container와 Backend Container는 HTTP 프로토콜로 연결된다. 포트 8000을 사용하여 통신하며 /api/*, /ws/* 경로 요청이 이 경로를 통해 전달된다.

Backend Container와 Database Container는 TCP 프로토콜로 연결된다. 포트 5432를 사용하여 통신하며 PostgreSQL Wire Protocol로 데이터베이스 쿼리가 전송된다.

Backend Container와 Google Gemini API는 HTTPS 프로토콜로 연결된다. Integration & Realtime 컴포넌트가 LLM과 Stable Diffusion 컴포넌트를 호출하여 AI 기능을 제공한다.

Backend Container와 OpenAI API는 HTTPS 프로토콜로 연결된다. Integration & Realtime 컴포넌트가 STT와 TTS 컴포넌트를 호출하여 음성 처리 기능을 제공한다.

Backend Container와 Mock Payment Gateway는 HTTPS 프로토콜로 연결된다. Integration & Realtime 컴포넌트가 결제 처리를 요청한다.


배포 관계와 구현 관계

배포 관계는 컴포넌트가 노드에 배포되는 관계를 나타낸다. <<deploy>> 스테레오타입으로 표시되며 논리적 소프트웨어 단위가 물리적 실행 환경에 설치됨을 의미한다. Customer Web App, Admin & Staff Web App, Common Components 컴포넌트는 Client Browser 노드에 배포되고, API Routers, Domain Services, Integration & Realtime, Persistence 컴포넌트는 Backend Container 노드에 배포된다. LLM, Stable Diffusion 컴포넌트는 Google Gemini API 노드에 배포되며, STT, TTS 컴포넌트는 OpenAI API 노드에 배포된다.

구현 관계는 아티팩트가 노드를 구현하는 관계를 나타낸다. <<implementation>> 스테레오타입으로 표시되며 물리적 파일이 실행 환경을 실제로 구성함을 의미한다. next-app.js, build/ 아티팩트는 Frontend Container 노드를 구현하고, main.py, uvicorn 아티팩트는 Backend Container 노드를 구현한다. postgres, pgdata/ 아티팩트는 Database Container 노드를 구현하며, caddy, Caddyfile 아티팩트는 Reverse Proxy Container 노드를 구현한다.


================================================================================

이상으로 Dinner Service 시스템의 배치 다이어그램 구성에 대한 설명을 마친다.
