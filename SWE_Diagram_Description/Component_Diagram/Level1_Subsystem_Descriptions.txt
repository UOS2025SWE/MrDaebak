Dinner Service System Level 1 서브시스템 설명

================================================================================

전체 시스템은 아래의 서브시스템으로 구성된다.
- Frontend 시스템
- Backend 시스템
- Database System
- AI Server 시스템


Frontend 시스템
- 웹 기반 사용자 인터페이스를 제공하는 클라이언트 애플리케이션이다.
- 고객용 주문 시스템(Customer Web App)과 관리자/직원용 백오피스(Admin & Staff Web App)를 포함한다.
- 음성 주문, 실시간 주문 추적, 결제 등의 기능을 제공한다.
- Next.js 15.5.2, React 19.1.0, TypeScript 5.x를 사용하여 작성된다.
- Tailwind CSS 3.4.0로 스타일링을 처리한다.


Backend 시스템
- RESTful API 및 WebSocket을 제공하는 애플리케이션 서버이다.
- 비즈니스 로직, 데이터 처리, 외부 서비스 통합을 담당한다.
- 14개의 API Router, 10개의 Domain Service, Integration & Realtime Layer, Persistence Layer로 구성된다.
- FastAPI, SQLAlchemy, Python 3.13을 사용하여 작성된다.
- JWT 기반 인증과 WebSocket 실시간 통신을 지원한다.


Database System
- PostgreSQL 기반 관계형 데이터베이스로 모든 애플리케이션 데이터를 영구 저장한다.
- 주문, 사용자, 메뉴, 재고, 이벤트, 결제 정보 등을 관리한다.
- SQLAlchemy ORM을 통해 접근하며, Connection Pooling과 Transaction Management를 제공한다.
- PostgreSQL (최신 버전)을 DBMS로 사용한다.
- Docker 환경에서 포트 15432를 사용하며 데이터베이스 이름은 dinner_service이다.


AI Server 시스템
- Redis 큐를 통해 전달받은 AI 작업을 처리하는 독립 워커 서비스이다.
- Worker 프로세스가 Redis 큐(ai:queue:stt, ai:queue:llm, ai:queue:image)를 모니터링하고 작업을 분배한다.
- Whisper STT Service를 통해 음성을 텍스트로 변환한다(openai/whisper-large-v3).
- Qwen LLM Service를 통해 자연어 이해 및 대화형 주문 분석을 수행한다(Qwen/Qwen3-4B-Instruct-2507).
- Stable Diffusion Image Service를 통해 커스텀 케이크 이미지를 생성한다(stabilityai/stable-diffusion-3.5-medium).
- 처리 결과를 Redis pub/sub 패턴으로 발행하여 Backend에 전달한다.
- FastAPI, Python 3.13, vLLM, Transformers를 사용하여 작성된다.


================================================================================
서브시스템 간 의존관계
================================================================================

컴포넌트 다이어그램에서 서브시스템 간의 점선은 다음의 경우를 의미한다.
- 시작 서브시스템이 대상 서브시스템의 기능을 호출하거나 데이터를 요청하는 의존관계
- 시작 서브시스템으로부터 대상 서브시스템으로 메시지 또는 데이터가 전달되는 경우


Frontend → Backend
- Frontend는 Backend의 RESTful API를 호출하여 데이터를 조회하고 조작한다.
- Frontend는 Backend의 WebSocket 서버에 연결하여 실시간 주문 상태 업데이트를 수신한다.
- HTTP/REST 프로토콜과 WebSocket 프로토콜을 사용한다.


Backend → PostgreSQL
- Backend는 PostgreSQL 데이터베이스에 애플리케이션 데이터를 저장하고 조회한다.
- SQLAlchemy ORM을 통해 데이터베이스 연산을 수행한다.
- PostgreSQL Wire Protocol을 사용한다.


Backend → AI Server
- Backend의 AIClient는 Redis 큐를 통해 AI Server에 작업을 비동기로 요청한다.
- STT 요청은 ai:queue:stt 큐로, LLM 요청은 ai:queue:llm 큐로, 이미지 생성 요청은 ai:queue:image 큐로 전송된다.
- AI Server는 작업 처리 후 결과를 ai:result:{request_id} 채널에 발행한다.
- Backend의 AIClient는 해당 채널을 구독하여 결과를 수신한다.
- Redis 프로토콜을 사용한다.


Backend → Mock Payment Gateway
- Backend의 PaymentService는 Mock Payment Gateway를 통해 결제를 처리한다.
- 결제 성공 시 주문 상태를 업데이트하고 결제 정보를 데이터베이스에 저장한다.
- 내부 메서드 호출로 구현되어 있으며, 프로덕션 환경에서는 HTTPS 프로토콜을 사용하는 실제 PG사 API로 전환된다.


================================================================================

이상으로 4개의 서브시스템과 의존관계에 대한 설명을 마친다.
